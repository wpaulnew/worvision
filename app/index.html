<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Hello World!</title>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,600,700,800,900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./main.css">
</head>
<body>

<div class="app">
  <div class="column-one">
    <div class="column-one-up">
      <input type="text" id="input-find" placeholder="Поиск">
    </div>
    <div class="column-one-center">
      <div id="tracks" class="tracks">
        <!--        <p>1. Будь прославленый</p>-->
        <!--        <p>2. Слава тебе и величие</p>-->
        <!--        <p>3. Вино</p>-->
        <!--        <p class="selected-music">4. Я знаю кто я в тебе</p>-->
        <!--        <p>5. Славь душа Господа</p>-->
      </div>
      <div class="favorites">
        <p class="selected-music">1. Я знаю кто я в тебе</p>
        <p>2. Славь душа Господа</p>
      </div>
    </div>
    <div class="column-one-down">
      <button id="action-button-add">
        <span id="action-button-add-icon"></span>
        <span id="action-button-add-text">Добавить</span>
      </button>
      <button id="action-button-favorite">
        <span id="action-button-favorite-icon"></span>
        <span id="action-button-favorite-text">Избраное</span>
      </button>
    </div>
  </div>
  <div class="column-two">
    <div class="column-two-up">
      <input type="text" id="input-music-name" placeholder="Я знаю кто я в тебе">
    </div>
    <div class="column-two-center">
      <!--<textarea id="textarea-music-text">Кто же я что Всевышний Царь меня призвал
--
Я блуждал но любовь Твоя, меня нашла. О, меня нашла.
--
Дал свободу мне Иисус навек я дитя Царя знаю я.
--
Я свободен, искуплен Им, Он милостив
--
Был я в рабстве греха но Ты, жизнью заплатил За мои грехи.
--
Дал свободу мне Иисус навек я дитя Царя знаю я.</textarea>
      -->
      <!-- Выводим текст по клику на экран -->
      <div id="textarea-music-text" contenteditable="true">
        <p>Кто же я что Всевышний Царь меня призвал</p>
        --
        <p>Я блуждал но любовь Твоя, меня нашла. О, меня нашла.</p>
        --
        <p>Дал свободу мне Иисус навек я дитя Царя знаю я.</p>
        --
        <p>Я свободен, искуплен Им, Он милостив</p>
        --
        <p>Был я в рабстве греха но Ты, жизнью заплатил За мои грехи.</p>
        --
        <p>Дал свободу мне Иисус навек я дитя Царя знаю я.</p>
      </div>
    </div>
    <div class="column-two-down">
      <button id="action-button-edit">
        <span id="action-button-edit-icon"></span>
        <span id="action-button-edit-text">Редактировать</span>
      </button>
      <button id="action-button-remove">
        <span id="action-button-remove-icon"></span>
        <span id="action-button-remove-text">Удалить</span>
      </button>
    </div>
  </div>
  <div class="column-three">
    <div class="column-three-up"></div>
    <div class="column-three-center">
      <div class="screen">
        <p id="screen-text">Кто же я что Всевышний Царь меня призвал</p>
      </div>
      <div class="screen-control">
        <button id="action-button-show-screen">
          <span id="action-button-show-screen-icon"></span>
        </button>
        <button id="action-button-hide-screen">
          <span id="action-button-hide-screen-icon"></span>
        </button>
      </div>
    </div>
    <div class="column-three-down"></div>
  </div>
</div>

<script>
  const electron = require('electron');
  const {ipcRenderer} = require('electron');

  ipcRenderer.send('variable-request', ['somevar', 'anothervar']);

  // Get music
  ipcRenderer.on('variable-reply', function (event, tracks) {
    let tracksContainer = document.getElementById('tracks');
    tracksContainer.innerHTML = '';

    tracks.map((track) => {
      let element = document.createElement('p');
      element.innerHTML = (track.id + 1) + '.' + ' ' + track.name;
      element.setAttribute('id', track.id);
      tracksContainer.appendChild(element);
    })
  });

  // Get track by id
  document.querySelector('#tracks').addEventListener('click', function (e) {
    // Вешаем обработчик клика на UL, не LI
    // Получили ID, т.к. в e.target содержится элемент по которому кликнули

    const id = e.target.getAttribute('id');
    // const text = e.target.innerText;
    // console.log(id);
    ipcRenderer.send('send-me-track', id);
  });

  let selectedTrackId = '';

  ipcRenderer.on('send-me-track-reply', function (event, track) {
    if (track !== null) {
      selectedTrackId = track.id;
      document.getElementById('textarea-music-text').innerHTML = '<p>' + track.text + '</p>';
    }
  });

  document.getElementById('action-button-edit').addEventListener('click', () => {
    const text = document.getElementById('textarea-music-text').innerHTML;
    ipcRenderer.send('update-track-text', {selectedTrackId, text});
  });

</script>
</body>
</html>
